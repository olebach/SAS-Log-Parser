/* JOBSPLIT: JOBSTARTTIME 26AUG2021:19:24:29.94 */
/* JOBSPLIT: TASKSTARTTIME 26AUG2021:19:24:29.94 */
/* JOBSPLIT: DATASET INPUT SEQ #C00003.CLASS.DATA */
/* JOBSPLIT: LIBNAME #C00003 V9 '/opt/sas/bin/SASFoundation/9.4/sashelp' */
/* JOBSPLIT: CONCATMEM #C00003 SASHELP */
/* JOBSPLIT: LIBNAME SASHELP V9 '( '/opt/sas/bin/SASFoundation/9.4/nls/u8/sascfg' '/opt/sas/bin/SASFoundation/9.4/nls/u8/sashelp' '/opt/sas/bin/SASFoundation/9.4/nls/en/sascfg' '/opt/sas/bin/SASFoundation/9.4/sashelp' )' */
/* JOBSPLIT: OPENTIME #C00003.CLASS.DATA DATE:26AUG2021:19:24:29.95 PHYS:/opt/sas/bin/SASFoundation/9.4/sashelp/class.sas7bdat SIZE:131072 */
/* JOBSPLIT: DATASET OUTPUT SEQ WORK.DATA1.DATA */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: ELAPSED 20  */
/* JOBSPLIT: SYSSCP LIN X64 */
/* JOBSPLIT: PROCNAME DATASTEP */
/* JOBSPLIT: STEP SOURCE FOLLOWS */


/* YOUR CODE HERE*/

/* Step 1 */
data work.data1;
	set sashelp.class;
run;

/* Step 2 */

/* JOBSPLIT: TASKSTARTTIME 26AUG2021:19:24:29.96 */
/* JOBSPLIT: DATASET INPUT SEQ WORK.DATA1.DATA */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: OPENTIME WORK.DATA1.DATA DATE:26AUG2021:19:24:29.97 PHYS:/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq/data1.sas7bdat SIZE:196608 */
/* JOBSPLIT: DATASET OUTPUT SEQ WORK.DATA2.DATA */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: ELAPSED 6  */
/* JOBSPLIT: PROCNAME DATASTEP */
/* JOBSPLIT: STEP SOURCE FOLLOWS */
data work.data2;
	set work.data1;
	log_h_w=log(height*weight);
run;

/* Step 3 */

/* JOBSPLIT: TASKSTARTTIME 26AUG2021:19:24:29.97 */
/* JOBSPLIT: DATASET INPUT SEQ WORK.DATA2.DATA */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: OPENTIME WORK.DATA2.DATA DATE:26AUG2021:19:24:29.97 PHYS:/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq/data2.sas7bdat SIZE:196608 */
/* JOBSPLIT: DATASET OUTPUT SEQ WORK.PROCSQL1.DATA */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: SYMBOL SET SYS_SQL_IP_ALL */
/* JOBSPLIT: SYMBOL SET SQLOBS */
/* JOBSPLIT: SYMBOL SET SQLOOPS */
/* JOBSPLIT: SYMBOL SET SQLXOBS */
/* JOBSPLIT: SYMBOL SET SQLXOPENERRS */
/* JOBSPLIT: SYMBOL SET SQLRC */
/* JOBSPLIT: SYMBOL SET SQLEXITCODE */
/* JOBSPLIT: SYMBOL SET SYS_SQL_IP_STMT */
/* JOBSPLIT: SYMBOL GET SYS_SQL_UNPUT_TRACE */
/* JOBSPLIT: SYMBOL GET SQLMAGIC */
/* JOBSPLIT: ELAPSED 7  */
/* JOBSPLIT: PROCNAME SQL */
/* JOBSPLIT: STEP SOURCE FOLLOWS */
proc sql;
	create table work.procsql1 as
		select *
				, log_h_w ** 2 as log_h_w_p2
		from work.data2
;quit;

/* Step 4 */

/* JOBSPLIT: TASKSTARTTIME 26AUG2021:19:24:29.98 */
/* JOBSPLIT: DATASET INPUT SEQ WORK.DATA1.DATA */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: OPENTIME WORK.DATA1.DATA DATE:26AUG2021:19:24:29.98 PHYS:/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq/data1.sas7bdat SIZE:196608 */
/* JOBSPLIT: DATASET INPUT SEQ WORK.DATA2.DATA */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: OPENTIME WORK.DATA2.DATA DATE:26AUG2021:19:24:29.98 PHYS:/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq/data2.sas7bdat SIZE:196608 */
/* JOBSPLIT: DATASET OUTPUT SEQ WORK.PROCSQL_JOIN1.DATA */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: SYMBOL SET SYS_SQL_IP_ALL */
/* JOBSPLIT: SYMBOL SET SQLOBS */
/* JOBSPLIT: SYMBOL SET SQLOOPS */
/* JOBSPLIT: SYMBOL SET SQLXOBS */
/* JOBSPLIT: SYMBOL SET SQLXOPENERRS */
/* JOBSPLIT: SYMBOL SET SQLRC */
/* JOBSPLIT: SYMBOL SET SQLEXITCODE */
/* JOBSPLIT: SYMBOL SET SYS_SQL_IP_STMT */
/* JOBSPLIT: SYMBOL GET SYS_SQL_UNPUT_TRACE */
/* JOBSPLIT: SYMBOL GET SQLMAGIC */
/* JOBSPLIT: SYMBOL GET SYSSORTMSGS */
/* JOBSPLIT: SYMBOL GET SYSSORTDETAILS */
/* JOBSPLIT: SYMBOL GET SYSSORTTRACELEVEL */
/* JOBSPLIT: SYMBOL GET SYSSORTTRACE */
/* JOBSPLIT: ELAPSED 9  */
/* JOBSPLIT: PROCNAME SQL */
/* JOBSPLIT: STEP SOURCE FOLLOWS */
proc sql;
	create table work.procsql_join1 as
		select ds1_join.*, ds2_join.log_h_w
		from work.data1 as ds1_join 
			left join work.data2 as ds2_join 
				on ds1_join.name=ds2_join.name
;quit;

/* Step 5 */

/* JOBSPLIT: TASKSTARTTIME 26AUG2021:19:24:29.99 */
/* JOBSPLIT: DATASET INPUT SEQ #C00003.CLASS.DATA */
/* JOBSPLIT: LIBNAME #C00003 V9 '/opt/sas/bin/SASFoundation/9.4/sashelp' */
/* JOBSPLIT: CONCATMEM #C00003 SASHELP */
/* JOBSPLIT: LIBNAME SASHELP V9 '( '/opt/sas/bin/SASFoundation/9.4/nls/u8/sascfg' '/opt/sas/bin/SASFoundation/9.4/nls/u8/sashelp' '/opt/sas/bin/SASFoundation/9.4/nls/en/sascfg' '/opt/sas/bin/SASFoundation/9.4/sashelp' )' */
/* JOBSPLIT: OPENTIME #C00003.CLASS.DATA DATE:26AUG2021:19:24:29.99 PHYS:/opt/sas/bin/SASFoundation/9.4/sashelp/class.sas7bdat SIZE:131072 */
/* JOBSPLIT: ITEMSTORE INPUT WORK.TEMPLAT */
/* JOBSPLIT: ITEMSTORE INPUT SASUSER.TEMPLAT */
/* JOBSPLIT: SYMBOL GET SYSSUMSTACKODS */
/* JOBSPLIT: SYMBOL GET SYSSUMTRACE */
/* JOBSPLIT: SYMBOL GET SYSZSQLCAS */
/* JOBSPLIT: ELAPSED 29  */
/* JOBSPLIT: PROCNAME MEANS */
/* JOBSPLIT: STEP SOURCE FOLLOWS */
proc means data=sashelp.class;
	var Age;
run;

/* Step 6 */

/* JOBSPLIT: TASKSTARTTIME 26AUG2021:19:24:30.02 */
/* JOBSPLIT: DATASET INPUT SEQ #C00003.CLASS.DATA */
/* JOBSPLIT: LIBNAME #C00003 V9 '/opt/sas/bin/SASFoundation/9.4/sashelp' */
/* JOBSPLIT: CONCATMEM #C00003 SASHELP */
/* JOBSPLIT: LIBNAME SASHELP V9 '( '/opt/sas/bin/SASFoundation/9.4/nls/u8/sascfg' '/opt/sas/bin/SASFoundation/9.4/nls/u8/sashelp' '/opt/sas/bin/SASFoundation/9.4/nls/en/sascfg' '/opt/sas/bin/SASFoundation/9.4/sashelp' )' */
/* JOBSPLIT: OPENTIME #C00003.CLASS.DATA DATE:26AUG2021:19:24:30.02 PHYS:/opt/sas/bin/SASFoundation/9.4/sashelp/class.sas7bdat SIZE:131072 */
/* JOBSPLIT: DATASET UPDATE MULTI WORK.'SASTMP-000000401'.UTILITY */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: ITEMSTORE INPUT WORK.TEMPLAT */
/* JOBSPLIT: ITEMSTORE INPUT SASUSER.TEMPLAT */
/* JOBSPLIT: CATALOG INPUT WORK.SASMAC1.TESTS.MACRO */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: SYMBOL GET _TESTTHREAD */
/* JOBSPLIT: SYMBOL GET _TESTTHREADFREQ */
/* JOBSPLIT: SYMBOL SET LIBNAME */
/* JOBSPLIT: SYMBOL SET DS */
/* JOBSPLIT: SYMBOL SET VAR */
/* JOBSPLIT: SYMBOL SET TEST */
/* JOBSPLIT: SYMBOL SET CLASS */
/* JOBSPLIT: SYMBOL GET TEST */
/* JOBSPLIT: ELAPSED 21  */
/* JOBSPLIT: PROCNAME FREQ */
/* JOBSPLIT: STEP SOURCE FOLLOWS */
proc freq data=sashelp.class;
	table Sex;
run;

/* Step 7 */

/* JOBSPLIT: TASKSTARTTIME 26AUG2021:19:24:30.04 */
/* JOBSPLIT: DATASET INPUT MULTI #C00003.CLASS.DATA */
/* JOBSPLIT: LIBNAME #C00003 V9 '/opt/sas/bin/SASFoundation/9.4/sashelp' */
/* JOBSPLIT: CONCATMEM #C00003 SASHELP */
/* JOBSPLIT: LIBNAME SASHELP V9 '( '/opt/sas/bin/SASFoundation/9.4/nls/u8/sascfg' '/opt/sas/bin/SASFoundation/9.4/nls/u8/sashelp' '/opt/sas/bin/SASFoundation/9.4/nls/en/sascfg' '/opt/sas/bin/SASFoundation/9.4/sashelp' )' */
/* JOBSPLIT: OPENTIME #C00003.CLASS.DATA DATE:26AUG2021:19:24:30.04 PHYS:/opt/sas/bin/SASFoundation/9.4/sashelp/class.sas7bdat SIZE:131072 */
/* JOBSPLIT: ITEMSTORE INPUT WORK.TEMPLAT */
/* JOBSPLIT: ITEMSTORE INPUT SASUSER.TEMPLAT */
/* JOBSPLIT: CATALOG INPUT WORK.SASMAC1.TESTS.MACRO */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: SYMBOL GET LIBNAME */
/* JOBSPLIT: SYMBOL GET DS */
/* JOBSPLIT: SYMBOL GET CLASS */
/* JOBSPLIT: SYMBOL GET VAR */
/* JOBSPLIT: SYMBOL SET LIBNAME */
/* JOBSPLIT: SYMBOL SET DS */
/* JOBSPLIT: SYMBOL SET VAR */
/* JOBSPLIT: SYMBOL SET TEST */
/* JOBSPLIT: SYMBOL SET CLASS */
/* JOBSPLIT: SYMBOL GET TEST */
/* JOBSPLIT: ELAPSED 32  */
/* JOBSPLIT: PROCNAME TTEST */
/* JOBSPLIT: STEP SOURCE FOLLOWS */
 proc ttest data=sashelp.class;
 class sex;
 var age;
 run;
;

/* Step 8 */

/* JOBSPLIT: TASKSTARTTIME 26AUG2021:19:24:30.07 */
/* JOBSPLIT: DATASET INPUT SEQ #C00003.CARS.DATA */
/* JOBSPLIT: LIBNAME #C00003 V9 '/opt/sas/bin/SASFoundation/9.4/sashelp' */
/* JOBSPLIT: CONCATMEM #C00003 SASHELP */
/* JOBSPLIT: LIBNAME SASHELP V9 '( '/opt/sas/bin/SASFoundation/9.4/nls/u8/sascfg' '/opt/sas/bin/SASFoundation/9.4/nls/u8/sashelp' '/opt/sas/bin/SASFoundation/9.4/nls/en/sascfg' '/opt/sas/bin/SASFoundation/9.4/sashelp' )' */
/* JOBSPLIT: OPENTIME #C00003.CARS.DATA DATE:26AUG2021:19:24:30.07 PHYS:/opt/sas/bin/SASFoundation/9.4/sashelp/cars.sas7bdat SIZE:196608 */
/* JOBSPLIT: DATASET UPDATE MULTI WORK.'SASTMP-000000404'.UTILITY */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: DATASET UPDATE MULTI WORK.'SASTMP-000000405'.UTILITY */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: ITEMSTORE INPUT WORK.TEMPLAT */
/* JOBSPLIT: ITEMSTORE INPUT SASUSER.TEMPLAT */
/* JOBSPLIT: ITEMSTORE OUTPUT . */
/* JOBSPLIT: SYMBOL GET LIBNAME */
/* JOBSPLIT: SYMBOL GET DS */
/* JOBSPLIT: SYMBOL GET CLASS */
/* JOBSPLIT: SYMBOL GET VAR */
/* JOBSPLIT: SYMBOL GET _TESTTHREAD */
/* JOBSPLIT: SYMBOL GET _TESTTHREADFREQ */
/* JOBSPLIT: SYMBOL GET _TKXC */
/* JOBSPLIT: ELAPSED 35  */
/* JOBSPLIT: PROCNAME FREQ */
/* JOBSPLIT: STEP SOURCE FOLLOWS */
 proc freq data=sashelp.cars;
 table origin * type/chisq;
 run;


/* Step 9 */

/* JOBSPLIT: TASKSTARTTIME 26AUG2021:19:24:30.11 */
/* JOBSPLIT: DATASET INPUT SEQ #C00003.CLASS.DATA */
/* JOBSPLIT: LIBNAME #C00003 V9 '/opt/sas/bin/SASFoundation/9.4/sashelp' */
/* JOBSPLIT: CONCATMEM #C00003 SASHELP */
/* JOBSPLIT: LIBNAME SASHELP V9 '( '/opt/sas/bin/SASFoundation/9.4/nls/u8/sascfg' '/opt/sas/bin/SASFoundation/9.4/nls/u8/sashelp' '/opt/sas/bin/SASFoundation/9.4/nls/en/sascfg' '/opt/sas/bin/SASFoundation/9.4/sashelp' )' */
/* JOBSPLIT: OPENTIME #C00003.CLASS.DATA DATE:26AUG2021:19:24:30.11 PHYS:/opt/sas/bin/SASFoundation/9.4/sashelp/class.sas7bdat SIZE:131072 */
/* JOBSPLIT: DATASET OUTPUT SEQ WORK.DATA3.DATA */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: ELAPSED 20  */
/* JOBSPLIT: PROCNAME DATASTEP */
/* JOBSPLIT: STEP SOURCE FOLLOWS */
data work.data3;
	set sashelp.class; where age ge 13;
	if sex = 'M' then projected_height=height*1.10;
	else if sex = 'F' then projected_height=height*1.075;
run;

/* Step 10 */

/* JOBSPLIT: TASKSTARTTIME 26AUG2021:19:24:30.13 */
/* JOBSPLIT: DATASET INPUT SEQ WORK.DATA3.DATA */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: OPENTIME WORK.DATA3.DATA DATE:26AUG2021:19:24:30.13 PHYS:/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq/data3.sas7bdat SIZE:196608 */
/* JOBSPLIT: DATASET OUTPUT SEQ WORK.SORT1.DATA */
/* JOBSPLIT: LIBNAME WORK V9 '/opt/sas/sasworkultra/SAS_workF0BD00006543_lrv180jq/SAS_work59ED00006543_lrv180jq' */
/* JOBSPLIT: FILE OUTPUT /opt/sas/data/vaa_ccmd/sasdata/05_Users/Bachynsky. O. (Oleksandr)/Stretch/sas_log.txt */
/* JOBSPLIT: SYMBOL GET SYSSORTDETAILS */
/* JOBSPLIT: SYMBOL GET SYSSORTTRACELEVEL */
/* JOBSPLIT: SYMBOL GET SYSSORTTRACE */
/* JOBSPLIT: ELAPSED 7  */
/* JOBSPLIT: PROCNAME SORT */
/* JOBSPLIT: STEP SOURCE FOLLOWS */
proc sort data=work.data3 out=work.sort1;
	by projected_height;
run;


/* WRITE LOG TO THE FILE IN PRIEVIOUSLY STATED FILE PATCH */

/* JOBSPLIT: JOBENDTIME 26AUG2021:19:24:30.14 */
/* JOBSPLIT: END */
